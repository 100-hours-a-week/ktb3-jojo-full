# week2 - 비동기 프로그램 만들기
---
## TODO
- [x] 게임 스레드로 변경하기
  - [x] 게임 스레드 : 상태 변경 담당 (타이머에서는 상태 절대 못바꿈)
- [x] 타이머 스레드 만들기
  - [x] 게임 턴 시작 시 10초 간 타이머 재생, timeout 여부 확인
- [x] 게임 스레드 동작 방식
  - [x] 플레이어의 액션이 기한 내에 도착한다면 타이머 취소
  - [x] 기한이 초과하면, 아무 행동 안하게 됨 (아무것도 안함 옵션 삭제 후 여기로)
- [ ] 예외처리 하기
- [ ] volatile 로 처리하던 상태를 lock 으로 변경해보기

---
## 의문점 및 회고 (solved 시 체크)

멀티스레드를 그냥 공부했을 때, 이해가 됐다는 생각으로 과제를 진행하려고 했는데,   
어떻게 기획을 해야하는지 감조차 잡히지 않아서 당황스러웠다.   

스레드가 필요한 상황이 감이 안잡혀서 가장 어려웠다.   
원래는 단순히 과제 예시처럼 몹 체력과 player 체력이 동시에 깎이도록 하려고 했는데, 
단일 스레드로 처리할 수 있는 부분을 억지로 멀티 스레드로 만드는 것 같아서 기획을 다시 했다. + 구현이 너무 어려워서 포기.
lock 도 사용해보고 싶고, 멀티스레드도 해보고싶어서 처음에 너무 욕심이 과했다.


- [x] 입력도 스레드로 빼야하나?
  > 초반에는 입력 스레드를 그냥 main 스레드에 포함시켰었는데 ....    
    타이머와 입력을 동시에 처리할 수 없어 문제가 발생했다. (코드 블록의 위치에 따라 동작을 일관적으로 처리할 수 없었다.)   
    10초동안 돌아가는 타이머에 입력을 받아서 입력 받는 여부 + 타이머 10초를 동시에 고려해야하니 ! gameThread 를 따로 만들게 아니고, input 을 스레드로 만들어서   
    동시에 처리될 수 있도록 해야했다.   
    너무어렵다...
- [ ] turnId 넣기 전, timer thread가 이전 timer 가 끝나지 않았던 에러가 있었다. 
- [ ] 스레드가 계속 돌아가는데, 다른 스레드가 해당 상황을 탐지해야하는 상황에서 문제가 생겼다... 
  - 간단한 상태니까 volatile 을 사용했는데! 상태값을 순환참조하는 것이 문제였다.
  - scanner.nextInt 는 블로킹IO니 다른처리 없이 스레드가 중단될 것이라고 예상했다.